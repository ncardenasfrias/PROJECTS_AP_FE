\documentclass[hidelinks,12pts]{article}
\usepackage[export]{adjustbox}
\usepackage{amsmath}
\usepackage{amssymb}
\usepackage[title,titletoc]{appendix}
\usepackage{array}
\usepackage[english]{babel}
\usepackage{bbm}
\usepackage{blindtext}
\usepackage{bookmark}
\usepackage{booktabs}
\usepackage{cancel}
\usepackage{caption}
\usepackage{csquotes}
\usepackage{enumerate}
\usepackage{enumitem}
\usepackage{epigraph}
\usepackage[left]{eurosym}
\usepackage{float}
\usepackage[bottom]{footmisc}
\usepackage[margin=0.9in]{geometry}
\usepackage{graphicx}
\usepackage{hyperref}
\usepackage{indentfirst}
\usepackage{listings}
\usepackage{lscape}
\usepackage{mathtools}
\usepackage{mdframed}
\usepackage{multirow}
\usepackage{multicol}
\usepackage[sort]{natbib}
\usepackage{parskip}
\usepackage{setspace}
\usepackage{subcaption}
\usepackage{titlesec}
\usepackage{tgpagella}
\usepackage{varwidth}
\usepackage{verbatim} %comment block
\usepackage{wrapfig}
\usepackage[dvipsnames]{xcolor}
\usepackage{xltabular}

\renewcommand{\epigraphsize}{\normalsize}
\setlength{\epigraphwidth}{0.7\textwidth}
\renewcommand{\textflush}{flushright}
\renewcommand{\sourceflush}{flushright}


\renewcommand\appendixpagename{Mathematical Appendix}
\renewcommand{\baselinestretch}{1.45}

\hypersetup{
    colorlinks=true, 
    urlcolor= Violet, 
    linkcolor=Black, 
    citecolor=Blue, 
    filecolor = Blue
    } 

%\usepackage{natbib}
\bibliographystyle{plainnat}
%\bibdata{My Library.bib}
%\usepackage[backend=biber, style=authoryear-icomp]{biblatex}

\DeclareMathOperator{\E}{\mathbb{E}}
\DeclareMathOperator{\Prb}{\mathbb{P}}
\DeclareMathOperator{\R}{\mathbb{R}}
\DeclareMathOperator{\N}{\mathbb{N}}
\DeclareMathOperator{\1}{\mathbbm{1}}
\newcommand{\ind}{\perp\!\!\!\!\perp}


\titleformat{\part}{\centering\normalfont\Large\bfseries}{\partname\hspace{5pt}\thepart\hspace{5pt}}{5pt}{--\ }

\titleformat{\part}{\centering\normalfont\Large\bfseries}{\partname\hspace{5pt}\thepart\hspace{5pt}}{5pt}{--\ }

\makeatletter
\def\@fnsymbol#1{\ensuremath{\ifcase#1\or \dagger\or \ddagger\or
   \mathsection\or \mathparagraph\or \|\or **\or \dagger\dagger
   \or \ddagger\ddagger \else\@ctrerr\fi}}
    \makeatother

%code snippets 
\definecolor{codegreen}{rgb}{0,0.6,0}
\definecolor{codegray}{rgb}{0.5,0.5,0.5}
\definecolor{codepurple}{rgb}{0.58,0,0.82}
\definecolor{backcolour}{rgb}{0.95,0.95,0.92}

\lstdefinestyle{mystyle}{
    backgroundcolor=\color{backcolour},   
    commentstyle=\color{codegreen},
    keywordstyle=\color{magenta},
    numberstyle=\tiny\color{codegray},
    stringstyle=\color{codepurple},
    basicstyle=\ttfamily\footnotesize,
    breakatwhitespace=false,         
    breaklines=true,                 
    captionpos=b,                    
    keepspaces=true,                 
    numbers=left,                    
    numbersep=5pt,                  
    showspaces=false,                
    showstringspaces=false,
    showtabs=false,                  
    tabsize=2
}

\lstset{style=mystyle}



\begin{document}

        \title{\scshape{Financial Econometrics 1 - M2 FTD \\ Empirical Applications}}
        \author{Luis Miguel Fonseca \\ Stéphane Eloundou Mvondo\\ Natalia Cárdenas Frías }
        \date{\today}
        \maketitle 

\tableofcontents
\newpage


\section*{Introduction} \addcontentsline{toc}{section}{\protect\numberline{}Introduction}
\textcolor{blue}{something, probably describe how all applications make sense one after the other and what the research question we could have made ourselves when doing the applications, try to give a coherent look to the whole thing.}

This document compiles all our applications for the Financial Econometrics course. 
Each section represents a specific application, but we tried to make them coherent across them around a broad question: 





\section{Series Dynamics}\label{sec:dynamics}

\subsection{Data}
\textcolor{gray}{\emph{Note:} Depending on each exercise along these applications we tried to use different series. We ended up testing more series than those taht we used therefore, this section encompasses more than the 3 series that were asked in the exercise.}

In this work, we focus on the US market.
We use the following series retreived for the most part from FRED with its Python API (FRED tickers are in square brakets) : 

\paragraph{GDP [GDP]} %log

\paragraph{Real Personal Disposable Income [DSPIC96]} %log


\paragraph{Inflation Expectation [MICH]}
This data series is made public by the University of Michigan from their Survey of Consumers. 
The series represents the median expected value of the percent change in prices over the next year. 
The series is not seasonally adjusted.


\paragraph{GDP deflator [A191RI1Q225SBEA]}  
As a measure of inflation, we decided to use the implicit price deflator of the US GDP. 
Unlike measures like the CPI deflators do not consider baskets of goods and therefore are broader measures of the price changes across the entire economy that measure the ratio of the GDP in value and volume. 
It is a measure produced by the US Bureau of Economic Analysis as a quarterly measure of percent change QoQ. 
The raw series is already seasonally adjusted at an annual rate. 
To get a monthly series, we interpolated the values within the same quarter using midpoints which implies that we assume that each month in a quarter contributes in the same way to the Q0Q change. 

%\paragraph{Unemployment rate [UNRATENSA]} It represents the share (in percent) of unemployed people over the labor force \footnote{The labor force data in this context encompasses people older than 16, living in the continental US, who don't reside in institutions like prisons or homes for the aged, and who are not in active duty in the military.}. The source is the 'Current Population Survey (Household Survey)' of the US Bureau of Labor Statistics


\paragraph{FED fund rate [DFF]}
Its source is the Board of Governors of the Federal Reserve System and it is a mayor tools in conducting monetary policy as it is interest rate at which banks and other depository institutions trade federal funds with each other overnight.
It is the main interest rate in the financial market and influences other interest rates.
The series is daily and expressed in percent. 
To have monthly frequency, we took the average of the rate at every month.


\paragraph{S\&P 500 price [SP500]} %log
It is the main index in the US stock market and teh series retresents its value at market close.
Its source is S&P Dow Jones Indices LLC and teh series is daily but the FRED series only has data from 2013. 
Since our analysis starts in the 1990s we complemented this series with Yahoo Finance's using its API. 
From the beggining of the analysis, we applied logs to this variable so all the information on its level is actually on the level of its log.


\begin{comment}
\paragraph{Corporate Debt Returns [BAMLCC0A0CMTRIV]}
The series represents the total returns of the debt index ICE Bank of America US Corporate Index value. 
This capitalization-weighted index tracks the performance if the following debt instruments\footnote{Taken from the \href{https://fred.stlouisfed.org/series/BAMLCC0A0CMTRIV}{FRED's website} }: 
    \begin{itemize}
        \item[-] Of corporate debt issued in USD in the US domestic market with an investment grade rating\footnote{To be considered to have an investment grade ranking to enter the index, the company and the country must be considered investment grade by the average of the ratings of Fitch, S\&P and Moody's.}. It must have a remaining maturity of at least one year, a fixed coupon and an outstanding amount of at least 250 million dollars.
        \item[-] Of original zero-coupon bonds ussued simultaneously in the US and the Eurobond market. 
        \item[-] Of 144a securities and pay-in-kind securities, including toggle notes, that can only be traded bu qualified institutional buyers with large portfolios. 
        \item[-] Of callable perpetual securities if they are at least one year from the first call date. 
        \item[-] Of fixed-to-floating rate securities if they are callable within the fixed rate period and are at least one year from the last call prior to the date the bond transitions from a fixed to a floating rate security. 
    \end{itemize}

The data's source is ICE Data Indices, and it is a daily series with close prices.
It is not seasonally adjusted. 
\end{comment}




\subsection{Unit root and trends}

As for any time series analysis, the first analysis to perform is regarding the presence of unit roots in the series that would make them non-stationary. 
To do so, we perform the Augmented Dickey-Fuller tests that evaluate the presence of a stochastic trend (a unit root), a deterministic trend, and an intercept or drift. 
Importantly, this test requires estimating three equations/specifications because it requires investigating the joint presence of both types of trends and drift, for them to discard elements one by one.
Each specification tests a different data-generating process of the series. 
For all specifications, the main null hypothesis H0 is that the series exhibits a UR. 
The inference with this test is non-standard and requires to use of corrected critical values to assess significance with the t-statistics. 



\subsubsection{ADF - Test jointly for deterministic and stochastic trend (with drift)}

We first run the following specification to the ADF test to \emph{jointly} investigate the presence of a stochastic and a determinist trend for each series $(X_t)_t$: 
    \begin{equation}
        \Delta X_t = \alpha + \beta t + \gamma X_{t-1} +\sum_{i=1,2,..}\rho_i \Delta X_{t-i} + \varepsilon_t
    \end{equation}
As per usual, the ADF test assumes H0: $\gamma =0$ i.e. a unit root exists and the series is non-stationary.
We use R's built-in function \texttt{ur.df} with \texttt{type='trend'} to get this estimation. This function gives us (i) a regression table per series and (ii) a summary table with the following test statistics: 
    \begin{itemize}
        \item[-] tau3 refers to the t-statistic associated to H0: $\gamma =0$ i.e. the presence of a UR. H1 refers to the absence of said UR.
        \item[-] phi2 refers to the F-statistic associated with H0: $\alpha = \beta = \gamma =0$ \footnote{As with all F-tests, the alternative hypothesis is that at least one of these coefficients is non-null. Since this is general, we don't explicitly signal the H1 hereafter.}
        \item[-] phi3 is also an F-statistic, now associated to H0: $\beta =\gamma = 0$  
    \end{itemize}
Remark that the critical value in both tables can be a little different. This is because they are sensitive to the number of observations in each series. In Table \ref{tab:adftrend_hyp}, the critical values correspond to those provided directly by R and are associated with $N=500$, while in Table \ref{tab:tstat_trend} we give the values for $N=250$. Since we have 396 data points per series we preferred to refer to the higher critical values but it does not change the analysis done.

Let us examine each series' results, summarized in the following tables: 

\input{TABLES/adf_trend.tex}
%\input{TABLES/prov_adf_trend.tex}
\input{TABLES/adf_tstats_trend.tex}

\paragraph{GDP}
We have $t_\gamma = -2.15 > -3.42$ we cannot reject the presence of a UR (H0). 
We shall note that phi2 ie that all coefficients are null is rejected since $F_{phi2} = 14.496 > 4.71$ while phi3 ($\gamma = \beta =0$) is not ($F_{phi3} = 2.388 < 6.3$). 
This suggests the absence of a deterministic trend which is confirmed when assessing the significance of $\beta$ using its non-standard critical value $|t_\beta| = 2.094 < 2.79$ (nullity, ie H0 cannot be rejected). 
These results require us to keep testing the series with the next specification of the test. 


\paragraph{Disposable personal income}
Similarly as before we find $t_\gamma = -2.694 > -3.42$ and we fail to reject H0. 
Regarding the joint nullity tests as before we reject phi2 ($F_{phi2} = 7.88 > 4.71$) and cannot reject phi3 ($F_{phi3} = 3.849 < 6.3$). 
We also fail to reject the nullity of $\beta$ as $|t_\beta| = 2.577 < 2.79$ and we shall test this series moving forward. 


\paragraph{Inflation expectation} 
We find $t_\gamma = -4.65 < -3.43$ we reject H0 ie we can't say that the series has a UR. 
The F-statistics of phi2 and phi3 lead us to reject their null hypothesis: $F_{phi2} = 7.375 > 4.71$, $F_{phi3} = 11.061 > 6.3$, leading us to believe that the series has either a drift and/or a deterministic trend. 
We, therefore, compare the t-statistics associated with $\alpha$ and $\beta$ to the standard interest threshold (the critical values below Table \ref{tab:tstat_trend} are conditional on having a UR). Since $|t_\alpha| = 4.004 > 1.96$ and $|t_\beta| = 1.265 < 1.96$, we fail to reject the presence of a deterministic trend while the drift term is significantly different from zero. 
We conclude that the series is \emph{stationnary with a constant and without a deterministic trend}.


%Note that the F-statistic corresponding to the nullity of all the coefficients of interest (phi2) leads us to reject H0: $\alpha=\beta=\gamma=0$ (same for phi3), 
%While we fail to reject that $\beta=0$ ($|t_\beta| = 1.35 < 1.95$ i.e. we don't have evidence of the existence of a deterministic trend), we can reject the nullity of $\alpha$ suggesting that we have a drift. 
    

\paragraph{GDP deflator}
With $t_\gamma = -5.197 < -3.43$, as before we can reject H0 indicating that the series is stationary in levels. 
Since $|t_\alpha| = 2.593 > 1.96$, we reject the nullity of the drift. 
Finally, since $|t_\beta| = 1.166 < 1.96$ we cannot reject the absence of a deterministic trend.  
We conclude that the series is \emph{stationary with a constant and without a deterministic trend}


%\paragraph{Unemployment rate} Since $t_\gamma = -3.346 > -3.43$, we fail to reject H0. We then test the significance of $\beta$ with respect to the non-standard threshold $2.79$ (bilateral test). Once again, the values of the F-statiss of the other two tests phi2 and phi3, lead us to believe that the series has a constant and/or a deterministic trend (we fail to reject both phi2 and phi3). The ADF methodology leads us to use the second specification for this series and discard the existence of a deterministic trend. 



\paragraph{Fed fund rate}  
$t_\gamma = -1.709 > -3.43$, we are in the same situation as the previous series where we cannot reject the existence of a UR. 
Because we cannot reject phi2 nor phi3 ($F_{phi2} = 2.015 <4.71, \: F_{phi3} = 2.917 <6.3$) we need to continue testing this series with the other specifications as we don't reject the existence of a stochastic trend and we cannnot reject the nullity of the trend coefficient ($|t_\beta| = 0.181 < 2.79$).


\paragraph{S\&P500}
Without many surprises for price series, $t_\gamma = -1.975 > -3.43$ and we cannot reject the existence of a UR. 
Moreover, $F_{phi2} = 3.875< 4.71$ and $F_{phi3} = 1.997 < 6.3$ (non-rejection of the null for both tests) leads to conclude that at least one of these coefficients is non-null (note that $|t_\beta| = 1.726 < 2.79$ and thus we cannot reject the nullity of $\beta$). 
We continue testing this series with the second specification of the test.
%Given the shape of the series, we decided to keep testing the presence of a UR in the second step of the ADF test.
% We do not reject the existence of a deterministic trend and we continue testing.

\begin{comment}
\paragraph{Corporate debt}
Finally, this series has $t_\gamma = -2.588 > -3.43$, $F_{phi2} = 5.6> 4.71$ and $F_{phi3} = 3.351 < 6.3$. %and $|t_\beta| = 1.696 < 2.79$. 
While we fail to reject the presence of a UR and that both $\gamma$ and $\beta$ are jointly null ($\beta$ is not significant as $|t_\beta| = 2.560 < 2.79$), we get that at least one coefficient is significantly different from zero, hinting to the constant. 
We need to continue to test this series too with the second specification of the ADF test. 
\end{comment}





\subsubsection{ADF - Test jointly for stochastic trend and drift}
The second specification of the test models $\forall (X_t)_t$: 
    \begin{equation}
        \Delta X_t = \alpha  + \gamma X_{t-1} +\sum_{i=1,2,..}\rho_i \Delta X_{t-i} + \varepsilon_t
    \end{equation}
The null hypothesis still refers to H0: $\gamma =0$ the presence of a unit root. 
We use now \texttt{type='trend'} in the \texttt{ur.df} function to get this estimation. 
The output of the test is similar to the previous specification and the same remarks on the critical values apply here. 
Now the test statistics reported refer to: 
    \begin{itemize}
        \item[-] tau2 refers to the t-statistic associated to $\gamma =0$ 
        \item[-] phi1 refers to the F-statistic associated to $\alpha = \gamma =0$ 
    \end{itemize}

\input{TABLES/adf_drift.tex}
\input{TABLES/adf_tstats_drift.tex}

\begin{comment}
\paragraph{Unemployment rate}
With $t_\gamma = -3.334<-2.88$ we reject H0: the series has no unit root.
We then chek the F-statistic associated to $H0: \gamma= \alpha = 0$, i.e. the test \emph{phi1} in the default R test. 
Given that $F_{phi1} = 5.57 > 4.61$, we reject the null suggesting that the series has a constant which is also supported by the significance of $\alpha$, $|t_\alpha| = 3.153 > 1.96$.
Since $\gamma$ is still significantly different from zero using the standard threshold $-1.64$, we finally conclude that the \emph{series is stationary with a constant (no deterministic trend)} at $5\%$. 
%However, the null is not rejected at the one percent level, and by looking at the series it does not look very stationary. Also R's built in function \texttt{order\_integration} concludes that the series is actually non-stationay which made us doubt our results. We decided to continue the test just in case and compare %$t_\gamma$ to the standard -1.64 threshold: since our statistic is larger, we conclude once again that the series is stationary.
\end{comment}

\paragraph{GDP}
We fail to reject the main null hypothesis (tau2) as $t_\gamma = -0.621 > -2.88$.
Moreover, we do reject the joint nullity of $\alpha$ and $\gamma$ as $F_{phi1} = 19.382 > 6.470$. 
Since we cannot reject the nullity of the drift term ($|t_\alpha| = 0.983< 2.53$), we shall use the last specification of the test on this series. 


\paragraph{Disposable personal income}
We fall in the same situation as with the previous series as tau2 is not rejected $t_\gamma = -1.02 > -2.88$ while phi1 is $F_{phi1} = 8.378 > 6.470$ and $\alpha$ is non-significant ($|t_\alpha| = 1.127< 2.53$). 
We therefore also test this series with the last test specification.


\paragraph{Fed fund rate}
Given that $t_\gamma = -2.412 >-2.88$, we cannot reject the null hypothesis. 
We then check the F-statistic of the joint test \emph{phi1}: $F_{phi1} = 3.014 < 4.61$: we cannot reject the null suggesting that the series has a UR and no drift.
Supporting this, we also find that the drift term is not significantly different from zero as $|t_\alpha| = 1.508 < 2.53$.
This leads us to use the third specification of the test.


\paragraph{S\&P500}
Since $t_\gamma = -1.005> -2.87$, we cannot reject H0.
By checking $F_{phi1} = 4.3 <4.61$ and $|t_\alpha| = 1.258 <2.53$, we fall in the same case as before where we need to continue testing the series as it seems to have a UR and no drift

\begin{comment}
\paragraph{Corporate debt}
For the last series, we find $t_\gamma = -0.383 > -2.87$, leading to a non-rejection of the null hypothesis. 
Once again we check the other two dtstistics: since $F_{phi1} = 5.051 > 4.61$ we reject the joint nullity of $\gamma$ and $\alpha$. 
We then test the significance of the drift coefficient: $|t_\alpha| = 1.824 < 2.53$ and that $\gamma$ is not significantly different fom zero. 
As with the previous series, this result requires us to keep testing the series in the simplest specification of the ADF test. 
\end{comment}




\subsubsection{ADF - Test for stochastic trend only}
The last specification of the test keeps only the stochastic trend, $\forall (X_t)_t$: 
    \begin{equation}
        \Delta X_t = \gamma X_{t-1} +\sum_{i=1,2,..}\rho_i \Delta X_{t-i} + \varepsilon_t
    \end{equation}
The null hypothesis still refers to H0: $\gamma =0$ the presence of a unit root and we use \texttt{type='none'}.
The output of the test is similar to the previous ones but now there is only one test statistic reported referring to the null (tau1).
For this step, we only report the table with the t-statistics as its value for the "gamma" row is identical to the test statistics of tau1.

%\input{TABLES/adf_none.tex}
\input{TABLES/adf_tstats_none.tex}

\paragraph{GDP}
We have $t_\gamma = 6.148> -1.95$. We clearly do not reject the presence of a UR (H0) and conclude that the \emph{series has a unit root with no constant nor time trend}.

\paragraph{Disposable personal income}
Since $t_\gamma = 3.934> -1.95$ we do not reject H0 and conclude that the \emph{series has a unit root with no constant nor time trend}.

\paragraph{Fed fund rate}
We find $t_\gamma = -1.935> -1.95$ thus we cannot reject the existence of a UR (this is a close call but seems adequate since we never rejected the UR and R's built-in \texttt{order\_integration} also indicates a UR). 
We conclude that the \emph{series has a unit root with no constant nor time trend}.


\paragraph{S\&P500}
Similarly, we find $t_\gamma = 2.647> -1.95$ and we cannot reject H0 and conclude that the \emph{series has a unit root with no constant nor time trend}.


%\paragraph{Corporate debt} Finally, given that $t_\gamma = 2.592> -1.95$ do not reject H0 and conclude that the \emph{series has a unit root with no constant nor time trend}.

%DECOMPOSITION SERIES IN DELTAS 



\subsubsection{Check stationarity of the series in deltas if UR in levels}

Finally, to properly conclude that the previous series with UR are indeed I(1), we need to check that the series of their first differences are stationary (i.e. the series in deltas is I(0)). 
We perform the same ADF procedure to test these transformed series. 

\input{TABLES/adf_deltas.tex}

Table \ref{tab:adfdeltas_hyp} reports the test results in the first specification of the ADF test. 
We easily see that all the $t_\gamma$ (the statistic on tau3) are sufficiently negative to reject H0 and conclude that none of the differentiated series has a UR. 
This is sufficient to conclude that the series of GDP, of real disposable individual income, of the Fed fund rate, and of the returns of the S\&P500 are indeed \emph{integrated of order one}. 

Moving forward, we will have to use these series in first-differences for models requiring statioanry series.
Note that for most of the series, these first-differences have the advantage of being easily interpretable. 
Namely for the (log) GDP and (log) disposable personal income, their series in delatas is teh series of their growth rate. 
For the S\&P500, the differenciated series are their rate of return. 
However, the interpretation of differenciated series of the Fed fund rate (in levels it was already a rate in percent) is not trivial as it does not have any intrisic meaning.






\subsection{Decomposition of the series}

All (monthly\footnote{One should adapt the number of indicators in the seasonal components according to the data frequency. To avoid multicollinearity issues, the number of dummies must be one less than the frequency of the series: here we have only 11 indicators.}) time series de can be decomposed into the following elements: 
    \begin{equation*}
        X_t =  \underbrace{\alpha}_{\text{drift}} + \underbrace{\beta \times t}_{\text{deterministic trend}} + \underbrace{\gamma Tt}_{\text{stochastic trend}} + \underbrace{\Sigma_{i=1}^{11} \rho_i \1_{\text{month = }i}}_{\text{seasonality}} + \underbrace{c_t}_{\text{cyclical component}}
    \end{equation*}

Remark that the coefficients in the previous equation need not be the same as in the ADF test (the variable on the left-hand side is now in levels while AD tests the series in deltas). 

We will apply this decomposition to stationary series. Therefore, the stochastic term $\gamma Tt = 0 $ for all series.

%Remark that according to definitions, the deterministic might as well include the drift/constants $\alpha$.
%Also, distinguishing the presence of a deterministic and stochastic trend needs to be done jointly and with specific procedures (see Section \ref{sec:adf} for the implementation of the ADF unit root tests). 

Using R's built-in function \texttt{stl}\footnote{Seasonal Decomposition of Time Series by Loess}, we can decompose the time series. 
The results are plotted in Figure \ref{fig:all_decompvf}.

\begin{figure}[h!]
    \centering
    \includegraphics[width=0.95\textwidth]{IMAGES/all_decompositions.png}
    \caption{Time series decomposition of stationary series (levels and deltas)}
    \label{fig:all_decompvf}
\end{figure}

\begin{comment} #subfigures with decompositions
\begin{figure}[h!]
    \centering
    \begin{subfigure}[b]{0.7\textwidth}
        \centering
        \includegraphics[width=\textwidth]{IMAGES/decomposition_i.png}
        \caption*{}
    \end{subfigure}
    \hfill
    \begin{subfigure}[b]{0.7\textwidth}
        \centering
        \includegraphics[width=\textwidth]{IMAGES/decomposition_ii.png}
        \caption*{}
    \end{subfigure}
    \hfill 
    \caption{Time series decomposition}
    \label{fig:decomposition}
\end{figure}
\end{comment}

    \subsubsection{Estimation of the parameters in the stationary series}

We perform we estimate the following regression to test the significance of the deterministic trend, drift and seasonal components:
    \begin{equation*}
        X_t = \alpha + \beta \times t + \sum_{i=1}^{11} \rho_i \1_{\text{month}=i} +c_t
    \end{equation*}

The results of this estimation are found in Table \ref{tab:ols_dec_levels} for the series that are I(0) in levels, and in Table \ref{tab:ols_dec_deltas} for the series of first differences of the series that were not stationary 

The coefficients on trend correspond to $\hat{\beta}$, those on the variables starting with M are $\hat{\rho_i}$. 
Since there is a monthly dummy less than the number of months, the coefficient on Contsnat encompasses both $\alpha$ and the coefficient on the last month. 
We tried to change the dummy that is ommitted and it does not change the results in terms of significance. 


\input{TABLES/ols_decomp_levels}
\input{TABLES/ols_decomp_deltas}

\begin{comment}
{Seasonality} \label{sec:adf}

From the decompositions made in the previous section, in Figure \ref{fig:decomposition} we can see that R picks up small seasonal variations in each series (the values on the y-axis are rather very small). 
The estimations of the seasonal coefficients are reported in Table \ref{tab:seasons}, which indeed shows very small coefficients.
We nonetheless decided to work with deseasonalized series even if the changes are minimal.

\input{TABLES/seasons.tex}
\end{comment}



    \subsection{Cyclical component}

To assess the behavior of the cyclical component, we detrend the series, substract the coefficient of the constant and remove the seasonal component when the coefficients are significant. After extracting these components, we would like to model them with appropiate $ARMA(p,q)$ models.

To do so, we first produce PACF (Figure \ref{fig:pacf_all}) and ACF graphs (Figure \ref{fig:acf_all}) to know respectively the maximum values that $p$ and $q$ could take, $\bar{p}, \bar{q}$.
The blue dotted lines onthe figures are the 95\% confidence intervals.
$\bar{p}, \bar{q}$ are given by the last period where the PACF or the ACF are significantly different from zero. 
We were surprised by the rather long memory of some of the processes, notably of the inflation expectation, the GDP deflator, and the first difference of the Fed fund rate series but we double checked and the series are stationary. 

\begin{figure}[h!]
    \centering
    \begin{subfigure}[b]{0.45\textwidth}
        \centering
        \includegraphics[width=\textwidth]{IMAGES/pacf_infl.png}
        \caption*{Inflation expectation}
    \end{subfigure}
    \hfill
    \begin{subfigure}[b]{0.45\textwidth}
        \centering
        \includegraphics[width=\textwidth]{IMAGES/pacf_defl.png}
        \caption*{GDP deflator}
    \end{subfigure}
    \hfill 
    \centering
    \begin{subfigure}[b]{0.45\textwidth}
        \centering
        \includegraphics[width=\textwidth]{IMAGES/pacf_gdp.png}
        \caption*{GDP growth rate}
    \end{subfigure}
    \hfill
    \begin{subfigure}[b]{0.45\textwidth}
        \centering
        \includegraphics[width=\textwidth]{IMAGES/pacf_dpi.png}
        \caption*{Real disponsable income growth rate }
    \end{subfigure}
    \hfill 
    \centering
    \begin{subfigure}[b]{0.45\textwidth}
        \centering
        \includegraphics[width=\textwidth]{IMAGES/pacf_rate.png}
        \caption*{Fed fund rate}
    \end{subfigure}
    \hfill
    \begin{subfigure}[b]{0.45\textwidth}
        \centering
        \includegraphics[width=\textwidth]{IMAGES/pacf_sp.png}
        \caption*{Returns of S\&P500}
    \end{subfigure}
    \hfill 
    \caption{PACFs}
    \label{fig:pacf_all}
    \begin{minipage}{0.9\textwidth}
        %\footnotesize
        \small{\emph{Notes}: All the series plotted are stationary: inflation expectation and GDP deflator series are in levels while the rest are first differences.}
    \end{minipage}
\end{figure}

\begin{figure}[h!]
    \centering
    \begin{subfigure}[b]{0.45\textwidth}
        \centering
        \includegraphics[width=\textwidth]{IMAGES/acf_infl.png}
        \caption*{Inflation expectation}
    \end{subfigure}
    \hfill
    \begin{subfigure}[b]{0.45\textwidth}
        \centering
        \includegraphics[width=\textwidth]{IMAGES/acf_defl.png}
        \caption*{GDP deflator}
    \end{subfigure}
    \hfill 
    \centering
    \begin{subfigure}[b]{0.45\textwidth}
        \centering
        \includegraphics[width=\textwidth]{IMAGES/acf_gdp.png}
        \caption*{GDP growth rate}
    \end{subfigure}
    \hfill
    \begin{subfigure}[b]{0.45\textwidth}
        \centering
        \includegraphics[width=\textwidth]{IMAGES/acf_dpi.png}
        \caption*{Real disponsable income growth rate }
    \end{subfigure}
    \hfill 
    \centering
    \begin{subfigure}[b]{0.45\textwidth}
        \centering
        \includegraphics[width=\textwidth]{IMAGES/acf_rate.png}
        \caption*{Fed fund rate}
    \end{subfigure}
    \hfill
    \begin{subfigure}[b]{0.45\textwidth}
        \centering
        \includegraphics[width=\textwidth]{IMAGES/acf_sp.png}
        \caption*{Returns of S\&P500}
    \end{subfigure}
    \hfill 
    \caption{ACFs}
    \label{fig:acf_all}
    \begin{minipage}{0.9\textwidth}
        %\footnotesize
        \small{\emph{Notes}: All the series plotted are stationary: inflation expectation and GDP deflator series are in levels while the rest are first differences.}
    \end{minipage}
\end{figure}

We then find the best parameters for each model by minimizing the BIC (an informational criteria) for each combination of $p \leq \bar{p}$ and $ \leq \bar{q}$. 
This will allow us to find a combination of both types of models (AR and MA) such that we capture well the past with less parameters to estimate.
To do so, we use R's \texttt{critMatrix} function with the option \texttt{criteria = 'bic'}. 
Importantly, this operation is slow in particular when $\bar{p}, \bar{q}$ are both large. In the case of the inflation expectation and the first difference of the Fed fund rate, their values were so large that R does not give any answer and reports an error. 
To solve this, we decided to take smaller values of $\bar{p}$. Indeed, by looking at the PACF graphs (Figure \ref{fig:pacf_all}), we see that in both cases there is a single lag down the line that is significantly different from zero after several ones falling in the CI (lag 13 for \emph{infl-e} and lag 15 for \emph{d-rate}). 
We took the previous significant lag as $\bar{p}$ to be able to get the information criteria with the rationale that those "extreme" significant lags can be due to just luck, and that the combination of AR and MA models should allow to reduce the number of parameters. 

We present the outputs of these comparitions tables per series in Appendix \ref{sec:BIC_tables} because they are a lot and they were making hard to read this section. 
Remark that the palcement of the $p$s and $q$s can vary from one tabel to the next due to formatting issues. 
We find that the orders $p$ and $q$ that minimize the nformation criteria are: 
    \begin{itemize}
        \item[-] Inflation expectation: $ARMA(1,0)$ (BIC = $236.04$)
        \item[-] GDP Deflator: $ARMA(2,1)$ (BIC = 164.23)  
        \item[-] GDP growth rate (\emph{d-gdp}): $ARMA(0,2)$ (BIC = -3556.28)
        \item[-] Real disposable income growth rate (\emph{d-dpi}): $ARMA(2,1)$ (BIC=-2161.22)
        \item[-] Fed Fund rate (\emph{d-rate}): $ARMA(1,1)$ (BIC = -413.58)
        \item[-] S\&P500 rate (\emph{d-splong}): $ARMA(0,1)$ (BIC = -1509.36)
    \end{itemize}

With this information we can finally estimate these ARMA models using R's \texttt{arima} function. 
Since all the series are stationary, we just set $d=0$ and the ARIMA models become ARMA. 
We get the following resuts: 
\input{TABLES/all_arma.tex}

Finally, we check that the residuals of the models aren't serially correlated using the Ljung–Box test that is available with R's \texttt{Box.test} function.
This test poses as a null hypothesis H0 that the data tested is independently distributed i.e. in this case, since we test the residuals, that there is no serial correlation between them.
The test results are found in Table \ref{tab:ljungbox}

\input{TABLES/ljuung_box.tex}

We cannot reject the null hypothesis in most of the models (p-values $< 0.05$) leading us to support the idea that for the inflation expectation, GDP growth, Fed fund rate and the return rate of the S\&P500, the ARMA models that we proposed before correctly captures the auto-correlation structure of their cyclical components.
However, we do reject H0 for the GDP deflator and the growth rate of disposable personal income suggesting that our models are not adequate. 
We couldn't find where the error might lie. 











\newpage
\newpage
\section{Canonical VAR model application}\label{sec:var}



\section{Cointegration theory}\label{sec:cointegration}



\newpage
\section{Impulse Response Analysis}\label{sec:irf}
    \subsection{Canonical IRF}\label{sec:canonical_irf}


    \subsection{Structural IRF}\label{sec:structural_irf}


\newpage
\section{Introduce non-linearities}\label{sec:nonlinearities}
    \subsection{Markov-switching model}\label{sec:markov}

    
    \subsection{STR model}\label{sec:str}



%\section{Difference-in-Difference}
%https://www.tidy-finance.org/r/difference-in-differences.html
    



\newpage
\newpage
\begin{appendices}

    \section{Section 1 - Additional tables} \label{sec:BIC_tables}
    \input{TABLES/BIC_arma_infl.tex}

    \input{TABLES/BIC_arma_deflator.tex}

    \input{TABLES/BIC_arma_gdp.tex}

    \input{TABLES/BIC_arma_dpi.tex}

    \input{TABLES/BIC_arma_rate.tex}

    \input{TABLES/BIC_arma_sp.tex}

    \newpage
    \section{Code - Data Cleaning} \label{sec:dta_clean}
        %\lstinputlisting[language=python]{DataCleaning.py}
        \lstinputlisting[language=Python]{DataCleaning.py}
    \newpage
    \section{Code - Analysis 1}
        \lstinputlisting[language=R]{Backup.R}

\end{appendices}







\end{document}